{% extends "base.html" %}
{% load static %}
{% load format_filters %}

{% block title %}Detalhes{% endblock %} 

{% block content %}
<div class="card">
  <div class="card-body text-bg-primary p-3 text-center">
    <h3 class="text-center">Detentos na Galeria {{ galeria.nome }} - {{ galeria.casa_prisional.nome }} ({{ galeria.casa_prisional.sigla }})</h3>
  </div>
</div>
<br>    
       <a href="{% url 'selecionar_presidio' %}"><i class="bi bi-arrow-return-left"></i> Voltar</a>
    {% if detentos %}
        <table class="table table-striped table-hover">
            <thead class="table-dark text-center">
                <tr class="align-middle">
                    <th>Foto</th>
                    <th>Nome</th>
                    <th>RG/CPF</th>
                    <th>Data de Nascimento</th>
                    <th>Alcunha</th>
                    <th>Situação Penal</th>
                    <th>Orcrim</th>
                    <th>Regime</th>
                </tr>
            </thead>
            <tbody>
                {% for detento in detentos %}
                    <tr class="align-middle">
                        <td class="text-center">
                            {% if detento.foto %}
                                <img src="{{ detento.foto.url }}" alt="Foto de {{ detento.nome }}" width="50" height="50">
                            {% else %}
                                Sem foto
                            {% endif %}
                        </td>
                        <td>{{ detento.nome }}</td>
                        <td>{{ detento.rg_cpf|formatar_cpf_rg|default:"Não Informado" }}</td>
                        <td class="text-center">{{ detento.data_nasc|date:"d/m/Y" }}</td>
                        <td class="text-center">{{ detento.alcunha|default:"N/A"}}</td>
                        <td class="text-center">
                            {% with detento.situacao_penal as status %}
                            {% if status == 'liberdade' %}
                            <span class="badge text-bg-success">{{ detento.get_situacao_penal_display }}</span>
                            {% elif status == 'recolhido' %}
                            <span class="badge text-bg-danger">{{ detento.get_situacao_penal_display }}</span>
                            {% elif status == 'recolhido_tornozeleira' %}
                            <span class="badge text-bg-info">{{ detento.get_situacao_penal_display }}</span>
                            {% elif status == 'foragido' %}
                            <span class="badge text-bg-warning">{{ detento.get_situacao_penal_display }}</span>
                            {% elif status == 'removido' %}
                            <span class="badge text-bg-secondary">{{ detento.get_situacao_penal_display }}</span>
                            {% else %}
                            <span class="badge text-bg-light">{{ detento.get_situacao_penal_display }}</span>
                            {% endif %}
                            {% endwith %}
                        </td>
                        <td class="text-center">{{ detento.orcrim|default:"N/A" }}</td>
                        <td class="text-center">{{ detento.get_regime_display }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>Nenhum detento encontrado nesta galeria.</p>
    {% endif %}
 
{% endblock %}